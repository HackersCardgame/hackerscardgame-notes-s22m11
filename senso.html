<!DOCTYPE html>
<html style="background-color:black;">
<body>

<style>
div {
  float: left;
  height: 300px;
  width: 300px;
}
</style>

    <div id="green">■</div> <div id="red">■</div>
    <div style="clear:both;" id="goldenrod">■</div> <div id="blue">■</div>
  
<script>

var color = ['green', 'red', 'goldenrod', 'blue'];

var sequence = [ getRandomInt(4) ];
var index = 0;
var last = sequence.length;

function getRandomInt(max) {
  return Math.floor(Math.random() * max);
}

function beep() {
  var context = new AudioContext();
  var oscillator = context.createOscillator();
  oscillator.type = "square";
  oscillator.frequency.value = 200;
  oscillator.connect(context.destination);
  oscillator.start(); 
  setTimeout(function () {
      oscillator.stop();
  }, 100);
}

function reset(nr)
{
  document.getElementById(color[nr]).style.backgroundColor = "dark"+color[nr];
}


function blink(nr)
{
  beep();
  document.getElementById(color[nr]).style.backgroundColor = color[nr];
  setTimeout(reset, 500, nr);
}

function display()
{
  for(i = 0; i < last; i++)
  {
    setTimeout(blink, 1000+i*1000, sequence[i]);
  }
}

function check(event, nr)
{
  beep();
  var target = event.target || event.srcElement;
  lastID = target.id;
  console.log(lastID, index, sequence[index], color[sequence[index]]);
  if (lastID == color[sequence[index]])
  {
    if (index==(last-1))
    {
      last += 1;
      sequence.push(getRandomInt(4));
      index=0;
      display();
      return;
    }
  }
  else
  {
    alert("FAIL");
    return;
  }
  index+=1;
}

function init(i) {
  document.getElementById(color[i]).style.backgroundColor = "dark"+color[i];
  const element = document.getElementById(color[i]);
  element.addEventListener("click", check);
}

for (i = 0; i < 4; i++)
{
  init(i);
}

display();





</script>

</body>
</html>

