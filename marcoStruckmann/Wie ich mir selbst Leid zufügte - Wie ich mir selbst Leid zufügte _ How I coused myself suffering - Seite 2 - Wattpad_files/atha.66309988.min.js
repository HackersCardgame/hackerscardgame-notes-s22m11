var __atha=function(){function u(){return _.get(window,"wattpad.testGroups.ADS_PROMETHEUS_METRICS",!1)}function p(e,d){window.te.push("event","ad","internal",null,e,d)}function f(e,d,a,t,i){var n=wattpad.utils.getDeviceType(),r=wattpad.utils.generateUUID(),s=_.get(window,"wattpad.testGroups.GDPR_USER",!1),w={id:r,created_at:(new Date).toISOString(),username:wattpad.utils.getCurrentUserAttr("username"),external_id:wattpad.utils.getCurrentUserAttr("externalId"),country_code:wattpad.userCountryCode,app_version:wattpad.revision,platform:"mobile"===n?"mobile-web":"desktop-web",gdpr_is_eu:s,storyid:d,page:e,is_brand_safe:window.ads.is_brand_safe,is_mature:window.ads.is_mature,content_rating:window.ads.content_rating,brand_safety_source:window.ads.brand_safety_source,brand_safety_level:window.ads.brand_safety_level,variation:function(){var e=[];return wattpad.testGroups.DELAY_ADS&&e.push("image_moderation=true"),wattpad.testGroups.EXCLUDE_PREBID_PARTNERS&&e.push("exclude_prebid_partners=true"),wattpad.testGroups.USE_KEVEL&&e.push("use_kevel=true"),wattpad.testGroups.USE_33ACROSS&&e.push("use_33across=true"),e.join("&")}()};return void 0!==t&&(w.is_brand_safe=!!t.isBrandSafe,w.is_mature=wattpad.utils.isMatureStory(t),w.brand_safety_source=t.brandSafetySource,w.brand_safety_level=t.brandSafetyLevel),void 0!==i&&(w.brand_safety_source=i.brandSafetySource,w.brand_safety_level=i.brandSafetyLevel),void 0!==a&&(w.part_id=a),w}var l="start_time";return{sendPageView:function(e,d,a,t,i){if(!u())return"";window.ads=window.ads||{};var n=f(e,d,a,t,i);return window.ads.page=e,window.ads.story_id=d,window.ads.part_id=a,window.ads.page_view_id=n.id,window.ads.is_brand_safe=n.is_brand_safe,window.ads.is_mature=n.is_mature,window.ads.content_rating=n.content_rating,window.ads.brand_safety_level=n.brand_safety_level,window.ads.brand_safety_source=n.brand_safety_source,n.user_is_premium=!!wattpad.utils.getCurrentUserAttr("isPremium"),n.story_tags=t&&Array.isArray(t.tags)?t.tags.join(" "):"",n.is_paid_story=t?t.isPaywalled:void 0,n.device_type=wattpad.utils.getDeviceType(),p("page_view",n),n.id},sendRequest:function(e,d,a){if(!u())return"";window.ads=window.ads||{},window.ads[e]=window.ads[e]||{};var t=window.ads[e].page=window.ads.page,i=window.ads[e].story_id=window.ads.story_id,n=window.ads[e].part_id=window.ads.part_id,r=0;window.ads[e].hasOwnProperty(l)?r=Date.now()-window.ads[e][l]:window.ads[e][l]=Date.now();var s=f(t,i,n);return s.zone_id=a.zoneId.toString(),s.placement=a.htSlotName,s.page_view_id=window.ads.page_view_id,s.adunit_id=e,s.request_offset=r,s.ad_partner=window.ads[e].ad_partner=d,window.ads[e][d+"_request"]=s.id,p("request",s),s.id},sendBid:function(e,d,a,t){if(!u())return"";var i=window.ads[e].page,n=window.ads[e].story_id,r=window.ads[e].part_id,s=window.ads[e].ad_partner,w=window.ads[e][s+"_request"],o=f(i,n,r),_=Date.now()-window.ads[e][l];return o.ad_partner=s,o.page_view_id=window.ads.page_view_id,o.adunit_id=e,o.partner_id=d,o.price=a,o.dimensions=t,o.request_id=w,o.request_offset=_,p("bid",o),o.id},sendAuctionResult:function(e,d,a){if(!u())return"";var t=window.ads[e].page,i=window.ads[e].story_id,n=window.ads[e].part_id,r=window.ads[e].ad_partner,s=Date.now()-window.ads[e][l],w=f(t,i,n);return w.ad_partner=r,w.page_view_id=window.ads.page_view_id,w.request_id=window.ads[e][r+"_request"],w.adunit_id=e,w.num_bids=a?a.length:0,w.price=d?d.bic:0,w.best_bid_id=d?d.id:null,w.request_offset=s,p("auction_result",w),w.id},sendImpression:function(e,d,a,t){if(!u())return"";var i=window.ads[e].page,n=window.ads[e].story_id,r=window.ads[e].part_id,s=window.ads[e].ad_partner,w=window.ads[e][s+"_request"],o=f(i,n,r),_=Date.now()-window.ads[e][l];return o.ad_partner=s,o.page_view_id=window.ads.page_view_id,o.adunit_id=e,o.price=t,o.request_id=w,o.placement=e.split("-")[0],o.zone_id=d,o.flight_id=a,o.request_offset=_,p("impression",o),o.id}}}();"undefined"!=typeof module&&(module.exports=__atha);
//# sourceMappingURL=atha.66309988.min.js.map
